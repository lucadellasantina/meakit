<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of util_plot_state_trans</title>
  <meta name="keywords" content="util_plot_state_trans">
  <meta name="description" content="UTIL_PLOT_STATE_TRANS Plot the state transitions of the selected">
  <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
    <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html Plot -->
<h1>util_plot_state_trans
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>UTIL_PLOT_STATE_TRANS Plot the state transitions of the selected</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [ elec_cluster ] = util_plot_state_trans( network_vector, seq, clu_sub, elec, varargin ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment" style="background-image:url(../brain.png)"><pre class="comment">UTIL_PLOT_STATE_TRANS Plot the state transitions of the selected
electrodes.
   Input:
           network_vector:     Network activity vectors (elecs * bins)
           seq:                The channel sequence indexer for
                               network_vector (very important when you
                               pickoff some 'inactive' channels).
           clu_sub:            The clustering results, generated by
                               util_extract_cluster. Through this, each
                               bin is assigned to a clustered state.
           elec:               Electrodes you want to analyze.
                               e.g. 12 / [14 22] / 'all'
           method:             'pl' / 'sc' / 'im' / 'no' [default]: 'pl'
           threshold:          The threshold for determining whether the
                               electrode is participating. 
                               [default]: 1. You may increase it with your
                               bin length (1:1000 ms), if = 0, channels
                               with few firings can be counted.
           remove0:            If true, remove the zero state which is
                               caused by no firings from the selected
                               electrode at the bin. [default]: 1

   Output:
           elec_cluster:       Assign the state transitions to each
                               electrodes by time bins.

   Example:
           [ elec_cluster ] = util_plot_state_trans( network_vectors, seq,
           subscript, 'all', 'threshold', 0, 'remove0', 1, 'method',
           'im');

   Created on Jul/27/2010 By Pu Jiangbo
   Britton Chance Center for Biomedical Photonics</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment" style="background-image:url(../brain.png)">
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../Calculation/util_convert_struct_2_vector_cluster.html" class="code" title="function [ cluvector ] = util_convert_struct_2_vector_cluster( clu_sub )">util_convert_struct_2_vector_cluster</a>	UTIL_CONVERT_STRUCT_2_VECTOR_CLUSTER Convert the clustering result from a</li><li><a href="../Common/util_convert_ch2hw.html" class="code" title="function [results] = util_convert_ch2hw(input)">util_convert_ch2hw</a>	UTIL_CONVERT_CH2HW Convert channel ID into hardware ID</li><li><a href="../Common/util_convert_hw2ch.html" class="code" title="function [results] = util_convert_hw2ch(input)">util_convert_hw2ch</a>	UTIL_CONVERT_CH2HW Convert hardware ID into channel ID</li><li><a href="../IO/mcd/mcintfac/pvpmod.html" class="code" title="function pvpmod(x)">pvpmod</a>	PVPMOD             - evaluate parameter/value pairs</li><li><a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>	TEMPLATE/SET Edit data stored in a Template object</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../Scripts/network_states.html" class="code" title="">network_states</a>	</li></ul>
</div>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment" style="background-image:url(../brain.png)"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [ elec_cluster ] = util_plot_state_trans( network_vector, seq, clu_sub, elec, varargin )</a>
0002 <span class="comment">%UTIL_PLOT_STATE_TRANS Plot the state transitions of the selected</span>
0003 <span class="comment">%electrodes.</span>
0004 <span class="comment">%   Input:</span>
0005 <span class="comment">%           network_vector:     Network activity vectors (elecs * bins)</span>
0006 <span class="comment">%           seq:                The channel sequence indexer for</span>
0007 <span class="comment">%                               network_vector (very important when you</span>
0008 <span class="comment">%                               pickoff some 'inactive' channels).</span>
0009 <span class="comment">%           clu_sub:            The clustering results, generated by</span>
0010 <span class="comment">%                               util_extract_cluster. Through this, each</span>
0011 <span class="comment">%                               bin is assigned to a clustered state.</span>
0012 <span class="comment">%           elec:               Electrodes you want to analyze.</span>
0013 <span class="comment">%                               e.g. 12 / [14 22] / 'all'</span>
0014 <span class="comment">%           method:             'pl' / 'sc' / 'im' / 'no' [default]: 'pl'</span>
0015 <span class="comment">%           threshold:          The threshold for determining whether the</span>
0016 <span class="comment">%                               electrode is participating.</span>
0017 <span class="comment">%                               [default]: 1. You may increase it with your</span>
0018 <span class="comment">%                               bin length (1:1000 ms), if = 0, channels</span>
0019 <span class="comment">%                               with few firings can be counted.</span>
0020 <span class="comment">%           remove0:            If true, remove the zero state which is</span>
0021 <span class="comment">%                               caused by no firings from the selected</span>
0022 <span class="comment">%                               electrode at the bin. [default]: 1</span>
0023 <span class="comment">%</span>
0024 <span class="comment">%   Output:</span>
0025 <span class="comment">%           elec_cluster:       Assign the state transitions to each</span>
0026 <span class="comment">%                               electrodes by time bins.</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%   Example:</span>
0029 <span class="comment">%           [ elec_cluster ] = util_plot_state_trans( network_vectors, seq,</span>
0030 <span class="comment">%           subscript, 'all', 'threshold', 0, 'remove0', 1, 'method',</span>
0031 <span class="comment">%           'im');</span>
0032 <span class="comment">%</span>
0033 <span class="comment">%   Created on Jul/27/2010 By Pu Jiangbo</span>
0034 <span class="comment">%   Britton Chance Center for Biomedical Photonics</span>
0035 
0036 <span class="comment">% Analyze parameters</span>
0037 <a href="../IO/mcd/mcintfac/pvpmod.html" class="code" title="function pvpmod(x)">pvpmod</a>(varargin);
0038 
0039 <span class="keyword">if</span> ~exist(<span class="string">'method'</span>, <span class="string">'var'</span>)
0040     method = <span class="string">'pl'</span>;
0041 <span class="keyword">end</span>
0042 
0043 <span class="keyword">if</span> ~exist(<span class="string">'threshold'</span>, <span class="string">'var'</span>)
0044     threshold = 1;
0045 <span class="keyword">end</span>
0046 
0047 <span class="keyword">if</span> ~exist(<span class="string">'remove0'</span>, <span class="string">'var'</span>)
0048     remove0 = true;
0049 <span class="keyword">end</span>
0050 
0051 <span class="keyword">if</span> ischar(elec)
0052     <span class="keyword">if</span> strcmpi(elec, <span class="string">'all'</span>)
0053         elec = <a href="../Common/util_convert_hw2ch.html" class="code" title="function [results] = util_convert_hw2ch(input)">util_convert_hw2ch</a>((1:64));
0054     <span class="keyword">end</span>
0055 <span class="keyword">end</span>
0056 
0057 <span class="comment">% Init</span>
0058 elec_cluster = zeros(length(elec), size(network_vector, 2));
0059 
0060 <span class="comment">% Convert struct to vector</span>
0061 clu_vec = <a href="../Calculation/util_convert_struct_2_vector_cluster.html" class="code" title="function [ cluvector ] = util_convert_struct_2_vector_cluster( clu_sub )">util_convert_struct_2_vector_cluster</a>(clu_sub);
0062 
0063 <span class="comment">% Assign states to each selected electrode</span>
0064 <span class="keyword">for</span> i = 1:length(elec)
0065     <span class="keyword">if</span> threshold == 0
0066         elec_cluster(i, network_vector(seq == <a href="../Common/util_convert_ch2hw.html" class="code" title="function [results] = util_convert_ch2hw(input)">util_convert_ch2hw</a>(elec(i)), :) &gt; threshold ) = <span class="keyword">...</span>
0067                 clu_vec(network_vector(seq == <a href="../Common/util_convert_ch2hw.html" class="code" title="function [results] = util_convert_ch2hw(input)">util_convert_ch2hw</a>(elec(i)), :) &gt; threshold);
0068     <span class="keyword">else</span>
0069         elec_cluster(i, network_vector(seq == <a href="../Common/util_convert_ch2hw.html" class="code" title="function [results] = util_convert_ch2hw(input)">util_convert_ch2hw</a>(elec(i)), :) &gt;= threshold ) = <span class="keyword">...</span>
0070                 clu_vec(network_vector(seq == <a href="../Common/util_convert_ch2hw.html" class="code" title="function [results] = util_convert_ch2hw(input)">util_convert_ch2hw</a>(elec(i)), :) &gt;= threshold);
0071     <span class="keyword">end</span>
0072     <span class="comment">%elec_cluster( i, network_vector(util_convert_ch2hw(elec(i)), :) &gt;= threshold ) = clu_vec( network_vector(util_convert_ch2hw(elec(i)), :) &gt;= threshold );</span>
0073 <span class="keyword">end</span>
0074 
0075 <span class="comment">% Remove zeros</span>
0076 <span class="keyword">if</span> remove0
0077     elec_cluster_r = cell(length(elec), 1);
0078     <span class="keyword">for</span> i = 1:length(elec)
0079        elec_cluster_r{i} = elec_cluster(i, elec_cluster(i, :) ~= 0 );
0080     <span class="keyword">end</span>
0081     elec_cluster = elec_cluster_r;
0082 <span class="keyword">end</span>
0083 
0084 <span class="comment">% Visualization</span>
0085 figure
0086 <span class="keyword">if</span> strcmpi(method, <span class="string">'pl'</span>)
0087     <span class="comment">% Prepare figure</span>
0088     <span class="keyword">for</span> i = 1:length(elec)
0089         <span class="keyword">if</span> remove0
0090             <span class="comment">% The data is in a cell array</span>
0091             plot(elec_cluster{i} + (i - 1) * (max(clu_vec) + 1), <span class="string">'color'</span>, <span class="string">'k'</span>, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'Marker'</span>, <span class="string">'.'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'k'</span>, <span class="string">'MarkerFaceColor'</span>, [0 0 0]);
0092         <span class="keyword">else</span>
0093             plot(elec_cluster(i,:) + (i - 1) * (max(clu_vec) + 1), <span class="string">'color'</span>, <span class="string">'k'</span>, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'Marker'</span>, <span class="string">'.'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'k'</span>, <span class="string">'MarkerFaceColor'</span>, [0 0 0]);
0094         <span class="keyword">end</span>
0095         hold on
0096     <span class="keyword">end</span>
0097     hold off
0098     
0099     <span class="comment">% Set label</span>
0100     xlim([0 size(network_vector, 2)])
0101     ylim([0 length(elec) * (max(clu_vec) + 1) - 1]);
0102     j = 1;
0103     <span class="keyword">for</span> i = 1:length(elec)
0104         <span class="keyword">for</span> clu_i = 0:max(clu_vec)
0105             yticklabel{j} = [num2str(elec(i)) <span class="string">' ('</span> num2str(clu_i) <span class="string">')'</span>];
0106             j = j + 1;
0107         <span class="keyword">end</span>
0108     <span class="keyword">end</span>
0109     <a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(gca, <span class="string">'ytick'</span>, [0:(length(elec) * (max(clu_vec) + 1) - 1)])
0110     <a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(gca, <span class="string">'yticklabel'</span>, yticklabel)
0111     xlabel(<span class="string">'Bins'</span>)
0112     ylabel(<span class="string">'Channels and States'</span>)
0113 <span class="keyword">elseif</span> strcmpi(method, <span class="string">'sc'</span>)
0114     <span class="comment">% Prepare figure</span>
0115     <span class="comment">% We use merely the same script as pl, because plot is faster than</span>
0116     <span class="comment">% scatter and currently, just change LineStyle from '-' to 'none' is</span>
0117     <span class="comment">% acceptable.</span>
0118     <span class="keyword">for</span> i = 1:length(elec)
0119         <span class="keyword">if</span> remove0
0120             <span class="comment">% The data is in a cell array</span>
0121             plot(elec_cluster{i} + (i - 1) * (max(clu_vec) + 1), <span class="string">'color'</span>, <span class="string">'k'</span>, <span class="string">'LineStyle'</span>, <span class="string">'none'</span>, <span class="string">'Marker'</span>, <span class="string">'.'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'k'</span>, <span class="string">'MarkerFaceColor'</span>, [0 0 0]);
0122         <span class="keyword">else</span>
0123             plot(elec_cluster(i,:) + (i - 1) * (max(clu_vec) + 1), <span class="string">'color'</span>, <span class="string">'k'</span>, <span class="string">'LineStyle'</span>, <span class="string">'none'</span>, <span class="string">'Marker'</span>, <span class="string">'.'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'k'</span>, <span class="string">'MarkerFaceColor'</span>, [0 0 0]);
0124         <span class="keyword">end</span>
0125         hold on
0126     <span class="keyword">end</span>
0127     hold off
0128     
0129     <span class="comment">% Set label</span>
0130     xlim([0 size(network_vector, 2)])
0131     ylim([0 length(elec) * (max(clu_vec) + 1) - 1]);
0132     j = 1;
0133     <span class="keyword">for</span> i = 1:length(elec)
0134         <span class="keyword">for</span> clu_i = 0:max(clu_vec)
0135             yticklabel{j} = [num2str(elec(i)) <span class="string">' ('</span> num2str(clu_i) <span class="string">')'</span>];
0136             j = j + 1;
0137         <span class="keyword">end</span>
0138     <span class="keyword">end</span>
0139     <a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(gca, <span class="string">'ytick'</span>, [0:(length(elec) * (max(clu_vec) + 1) - 1)])
0140     <a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(gca, <span class="string">'yticklabel'</span>, yticklabel)
0141     xlabel(<span class="string">'Bins'</span>)
0142     ylabel(<span class="string">'Channels and States'</span>)
0143 <span class="keyword">elseif</span> strcmpi(method, <span class="string">'im'</span>)
0144     <span class="comment">% Prepare figure</span>
0145     <span class="keyword">if</span> remove0
0146         <span class="comment">% The data is in a cell array</span>
0147         <span class="comment">% I dont think it is useful to implement this.</span>
0148         disp(<span class="string">'Sorry, this part is not yet implemented'</span>);
0149         <span class="keyword">return</span>
0150     <span class="keyword">else</span>
0151         imagesc(elec_cluster);
0152     <span class="keyword">end</span>
0153     
0154     axis xy
0155     xlabel(<span class="string">'Bins'</span>)
0156     ylabel(<span class="string">'Channels (Hardware Index)'</span>)
0157     
0158     <span class="comment">% Set colorbar label</span>
0159     cbar_yticklabel = {};
0160     <span class="keyword">for</span> i = 0:max(clu_vec)
0161         cbar_yticklabel = [cbar_yticklabel {num2str(i)}];
0162     <span class="keyword">end</span>
0163     colormap(jet(max(clu_vec) + 1));
0164     cbar_axes = colorbar(<span class="string">'YTick'</span>, (0:max(clu_vec)), <span class="string">'YTickLabel'</span>, cbar_yticklabel);
0165     <a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(cbar_axes, <span class="string">'box'</span>, <span class="string">'off'</span>);
0166     <a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(cbar_axes, <span class="string">'TickDir'</span>, <span class="string">'out'</span>);
0167     <a href="../Otherbox/m2html/@template/set.html" class="code" title="function tpl = set(tpl,action,varargin)">set</a>(cbar_axes, <span class="string">'YTickMode'</span>,<span class="string">'manual'</span>);
0168 <span class="keyword">elseif</span> strcmpi(method, <span class="string">'no'</span>)
0169     disp(<span class="string">'No figure is generated.'</span>);
0170 <span class="keyword">else</span>
0171     error(<span class="string">'Not supported yet'</span>);
0172 <span class="keyword">end</span>
0173 
0174 
0175 
0176 <span class="keyword">end</span>
0177</pre></div>
<hr><address>Copyright (C) 2008-2010 Pu Jiangbo @ Britton Chance Center for Biomedical Photonics<br/>Generated on Fri 22-Jun-2012 16:47:48</address>
</body>
</html>